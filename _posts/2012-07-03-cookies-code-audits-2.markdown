---
layout: post
title: "Cookies - Code Audits #2"
date: 2012-07-03 10:00:00 -0400
comments: true
published: true
categories: ["blog", "archives"]
tags: ["Blog"]
alias: ["/post/Cookies-Code-Audits-2", "/post/cookies-code-audits-2"]
---
<!-- more -->

<p>This is the second post in what I hope to make as a 30 post series of blogs about things I’ve seen in different code bases over my years as a software consultant. I will not be mentioning any client’s names or giving any easy way for people to identify the client whose code base has or did have any of these issues.</p>  <p>My team and I are often brought in on existing projects where the original development team failed to complete the code, created a big ball of mud that made bugs common and features slow to create, or simply where the previous team has completed the work and the customer just wants to know the quality of the code base. </p>  <h3>Cookies</h3>  <p>Cookies are a great way for developers to keep track of which client is communicating with them. They can store information in the browser. That sounds great doesn’t it?</p>  <p>The cookie gets an expiration date and is accessible from ASP.NET when the user visits your site. This gives you a chance to look at the cookie and get the information that has been stored in the cookie. </p>  <p>The cookie is able to expire when you want it to and will allow the user to close their browser, come back later, and still have the cookie being identified by your site.</p>  <p>These are most often used a means of identifying a user. When you log in to a site, you will get a cookie, which has a unique identifier allowing the site to identify you during that session.</p>  <h3>What should be stored in a cookie?</h3>  <ul>   <li>Temporary GUIDs </li>    <li>Unimportant information </li>    <li>Tracking information that in no way identifies the user </li> </ul>  <h3></h3>  <h3>Interesting things found in cookies</h3>  <p>You can find all kinds of things getting stored in cookies. Now might be a good time to go looking through your own browser’s cookies to see what things sites have stored there.</p>  <h4></h4>  <h4>Full Address Information</h4>  <p>One site had an interesting way of making sure it always had access to your relevant information. It kept it all stored in a cookie. Yes, it had your name, address, phone number, email address, etc. stored in a cookie. I bet you’re really happy to know that the information is being stored in a cookie where pretty much any interested party can access it.</p>  <p>This means that anyone sniffing your traffic would see these values being passed when you navigate around the site. Also, it keeps everything nicely packaged up for consumption by spyware or other malware.</p>  <h4>Username and Password Information</h4>  <p>Ever wonder how a site lets you “Stay logged in for 30 days”? Well I hope the site you’re using doesn’t do it the same way as this one. One application used a cookie to keep your username and password… Where anyone can get it… and it wasn’t encrypted or anything… Clear text…</p>  <p>I think this one explains itself.</p>  <h4>You account number and access rights</h4>  <p>When you log in to a site, you get access to your stuff and not other people’s stuff. One site whose codebase I’ve seen kept track of this information by storing the account number in the cookie. (<a href="http://brendan.enrick.com/post/URL-Parameters-Code-Audits-1.aspx" target="_blank">At least it wasn’t in the address bar</a>.) Yes, that’s correct. If you just change the account in your cookie, you can see someone else’s account.</p>  <p>One might expect at least a GUID, so it would be hard to guess the other account number, but one would be wrong. These account numbers were integers starting at the number… 1. Each was incremented sequentially by one.</p>  <h3>More Code Audit Nuggets</h3>  <p>Keep watching for more interesting nuggets of stuff that I’ve seen in codebases.</p>
